<?php
class skin_weblinks {
	function objListHtml($objItems = array(), $option = array()) {		global $bw, $vsLang;
		$BWHTML .= <<<EOF			<div class="red">{$option['message']}</div>			<form id="obj-list-form">				<input type="hidden" name="checkedObj" id="checked-obj" value="" />				<input type="hidden" name="categoryId" value="{$option['categoryId']}" id="categoryId" />				<div class='ui-dialog ui-widget ui-widget-content ui-corner-all'>				    <div class="ui-dialog-titlebar ui-widget-header ui-helper-clearfix ui-corner-all-inner">				        <span class="ui-icon ui-icon-note"></span>				        <span class="ui-dialog-title">{$vsLang->getWords('obj_objListHtmlTitle',"{$bw->input[0]} Item List")}</span>				    </div>				    <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-corner-all-inner ui-widget-header">				    	<li class="ui-state-default ui-corner-top" id="add-objlist-bt"><a href="#" title="{$vsLang->getWords('add_obj_alt_bt',"Add {$bw->input[0]}")}">{$vsLang->getWords('add_obj_alt_bt',"Add {$bw->input[0]}")}</a></li>				        <li class="ui-state-default ui-corner-top" id="hide-objlist-bt"><a href="#" title="{$vsLang->getWords('hide_obj_alt_bt',"Hide selected {$bw->input[0]}")}">{$vsLang->getWords('hide_obj_bt','Hide')}</a></li>				        <li class="ui-state-default ui-corner-top" id="visible-objlist-bt"><a href="#" title="{$vsLang->getWords('visible_obj_alt_bt',"Visible selected {$bw->input[0]} ")}">{$vsLang->getWords('visible_obj_bt','Visible')}</a></li>				        <li class="ui-state-default ui-corner-top" id="delete-objlist-bt"><a href="#" title="{$vsLang->getWords('delete_obj_alt_bt',"Delete selected {$bw->input[0]}")}">{$vsLang->getWords('delete_obj_bt','Delete')}</a></li>				    </ul>					<table cellspacing="1" cellpadding="1" id='objListHtmlTable' width="100% !important">						<thead>						    <tr>						        <th width="15"><input type="checkbox" onclick="vsf.checkAll()" name="all" /></th>						        <th width="60">{$vsLang->getWords('obj_list_status', 'Active')}</th>						        <th >{$vsLang->getWords('obj_list_title', 'Title')}</td>						        <th width="20">{$vsLang->getWords('obj_list_index', 'Thứ tự')}</th>						    </tr>						</thead>						<tbody>							<foreach="$objItems as $obj">								<tr class="$class $vsf_class">									<td align="center">										<input type="checkbox"  onclick="vsf.checkObject();" name="obj_{$obj->getId()}" value="{$obj->getId()}" class="myCheckbox" />									</td>									<td style='text-align:center'>{$obj->getStatus('image')}</td>									<td>										<a href="javascript:vsf.get('{$bw->input[0]}/add-edit-obj-form/{$obj->getId()}/','obj-panel')" title='{$vsLang->getWords('newsItem_EditObjTitle',"Click here to edit this {$bw->input[0]}")}' style='color:#000 !important;' >										{$obj->getTitle()}										</a>									</td>									<td>{$obj->getIndex()}</td>																</tr>							</foreach>						</tbody>							</tr>						<tfoot>							<tr>								<th colspan='5'>									<div style='float:right;'>{$option['paging']}</div>								</th>							</tr>						</tfoot>					</table>				<table cellspacing="1" cellpadding="1" id="objListInfo" width="100%">                     <tbody>                          <tr align="left">                            <span style="padding-left: 10px;line-height:16px;"><img src="{$bw->vars['img_url']}/enable.png" />{$vsLang->getWords('global_status_enable', 'Enable')}</span>                            <span style="padding-left: 10px;line-height:16px;"><img src="{$bw->vars['img_url']}/disabled.png" /> {$vsLang->getWords('global_status_disabled', 'Disable')}</span>                            <span style="padding-left: 10px;line-height:16px;"><img src="{$bw->vars['img_url']}/home.png" /> {$vsLang->getWords('global_status_ishome', 'Show on home page')}</span>                           </tr>                     </tbody>                </table>				</div>			</form>			<div id="albumn"></div>			<script type="text/javascript">				$('#add-objlist-bt').click(function(){										vsf.get('{$bw->input[0]}/add-edit-obj-form/&pageCate={$bw->input[2]}','obj-panel');				});
				$('#hide-objlist-bt').click(function() {					if(vsf.checkValue())					vsf.get('{$bw->input[0]}/hide-checked-obj/'+$('#checked-obj').val()+'/&pageIndex={$bw->input[3]}&pageCate={$bw->input[2]}', 'obj-panel');				});
				$('#visible-objlist-bt').click(function() {					if(vsf.checkValue())					vsf.get('{$bw->input[0]}/visible-checked-obj/'+$('#checked-obj').val()+'/&pageIndex={$bw->input[3]}&pageCate={$bw->input[2]}', 'obj-panel');				});
				$('#delete-objlist-bt').click(function() {					if(vsf.checkValue())					jConfirm(						"{$vsLang->getWords('obj_delete_confirm', "Are you sure want to delete this {$bw->input[0]}?")}",						"{$bw->vars['global_websitename']} Dialog",						function(r) {							if(r) {								vsf.get('{$bw->input[0]}/delete-checked-obj/'+$('#checked-obj').val()+'/&pageIndex={$bw->input[3]}&pageCate={$bw->input[2]}', 'obj-panel');							}						}					);				});			</script>EOF;	}
	function addEditObjForm($objItem, $option = array()) {		global $vsLang, $bw, $vsSettings, $vsStd;							if($objItem->getStatus()) 			$newStatus = $objItem->getStatus();		else 			$newStatus = 1;					$max_upload_size = min($vsStd->let_to_num(ini_get('post_max_size')), $vsStd->let_to_num(ini_get('upload_max_filesize')));		
		$BWHTML .= <<<EOF			<div id="error-message" name="error-message"></div>			<form id='add-edit-obj-form' name="add-edit-obj-form" method="POST"  enctype='multipart/form-data'>				<input type="hidden" id="obj-cat-id" name="weblinkCatId" value="{$objItem->getCatId()}" />				<input type="hidden" name="weblinkId" value="{$objItem->getId()}" />				<div class='ui-dialog ui-widget ui-widget-content ui-corner-all'>					<div class="ui-dialog-titlebar ui-widget-header ui-helper-clearfix ui-corner-all-inner">						<span class="ui-dialog-title">{$option['formTitle']}</span>						<p style="align:right; float: right; color: #FFFFFF; cursor: pointer"><span id="close">{$vsLang->getWords('obj_back', 'Back')}</span></p>					</div>					<table class="ui-dialog-content ui-widget-content" cellspacing="1" border="0" style="width:100%">                  	<tr class="smalltitle">							<td class="label_obj">{$vsLang->getWords('obj_title', 'Title')}:</td>							<td><input size="43" type="text" name="weblinkTitle" value="{$objItem->getTitle()}" id="obj-title"/></td>							<if="$vsSettings->getSystemKey($bw->input[0].'_image', 1, $bw->input[0])">								<td align='left' rowspan="5">	                          			{$objItem->createImageCache($objItem->getFileId(), 250, 150)}	                          			<input name="oldImage" value="{$objItem->getFileId()}" type="hidden" />	                          			<p>{$vsLang->getWords('obj_image_dellete', 'Delete Image')}<input type="checkbox" class="checkbox" name="weblinkDeleteImage" /></p>																</td>							</if>					</tr>					<if="$vsSettings->getSystemKey($bw->input[0].'_address', 1, $bw->input[0])">						<tr class="smalltitle">							<td class="label_obj">{$vsLang->getWords('obj_address', 'Address')}:</td>							<td><input size="43" type="text" name="weblinkAddress" value="{$objItem->getAddress()}" id="obj-address"/></td>						</tr>					</if>					<tr class="smalltitle">						<td class="label_obj">{$vsLang->getWords('obj_website', 'Website Name')}:</td>						<td><input size="43" type="text" name="weblinkWebsite" value="{$objItem->getWebsite()}" id="obj-website"/></td>					</tr>                 	<tr class="smalltitle">                     	<td class="label_obj">{$vsLang->getWords('obj_Index', 'Index')}:</td>						<td><input size="43" type="text" name="weblinkIndex" value="{$objItem->getIndex()}" id="obj-Index"/></td>					</tr>                 	<tr class="smalltitle">						<td class="label_obj">{$vsLang->getWords('obj_Status', 'Active')}:</td>                     	<td>                     		<input type="radio" value="0" name="weblinkStatus" id="weblinkStatus" class="radio">							<label style="padding-right: 10px" for="left">{$vsLang->getWords('global_hidden', "Ẩn")}</label>                        	<input type="radio" value="1" name="weblinkStatus" id="weblinkStatus" class="radio">						   	<label style="padding-right: 10px" for="left">{$vsLang->getWords('global_active', "Hiện")}</label>                     		<if="$vsSettings->getSystemKey($bw->input[0].'_ishome',1)">                            	<input type="radio" value="2" name="weblinkStatus" id="weblinkStatus" class="radio">                            	<label style="padding-right: 10px" for="left">{$vsLang->getWords('global_ishome', "Trang chủ")}</label>                      		</if>                      	</td>					</tr>                    <if="$vsSettings->getSystemKey($bw->input[0].'_image', 1, $bw->input[0])">						<tr class="smalltitle">							<td>{$vsLang->getWords('obj_image_file', "File")}:<input onclick="checkedLinkFile($('#link-file').val());" onclicktext="checkedLinkFile($('#link-file').val());" type="radio" id="link-file" name="link-file" value="file" checked="checked"/></td>							<td id="pageImage">								<div style="width: 180px; height: 18px; border: solid 1px #7FAAFF; background-color: #C5D9FF; padding: 2px;">									<span id="spanButtonPlaceholder"></span>								</div>								<div id="fsUploadProgress"></div>											        		<script>									$(window).ready(function() {										var swfu;										swfu = new SWFUpload(vsf.uploadSWF($max_upload_size,['add-edit-obj-form','spanButtonPlaceholder','fsUploadProgress',''],'{$option['key']}','{$option['key']}',["{$vsSettings->getSystemKey('global_file_image_extend',"*.doc;*.docx;*.xls;*.xlsx;*.ppt;*.pptx;*.csv;*.xps;*.pdf;*.zip;*.rar","global",  0, 1)}","Documents"]));									});								</script>							</td>							<td></td>						</tr>                    </if>					<tr class="smalltitle">						<td class="ui-dialog-buttonpanel" colspan="4" align="center">							<input type="submit" name="submit" value="{$option['formSubmit']}" />						</td>					</tr>				</table>				</div>			</form>			<script language="javascript">				function updateobjListHtml(categoryId){					vsf.get('{$bw->input[0]}/display-obj-list/'+categoryId+'/','obj-panel');				}				function alertError(message){					jAlert(message,'{$bw->vars['global_websitename']} Dialog');				}                $("#close").click(function(){					vsf.get('{$bw->input[0]}/display-obj-list', 'obj-panel');                });
				$(window).ready(function() {					$("input.numeric").numeric();					vsf.jRadio('{$newStatus}','weblinkStatus');					                    vsf.jSelect('{$objItem->getCatId()}','obj-category');                    $('#add-edit-obj-form').submit(function(){						var flag  = true;						var error = "";						var categoryId = "";						var count=0;                    	if(!$("#obj-cat-id").val())                     		$("#obj-cat-id").val($("#idCategory").val());						var catId = $("#obj-cat-id").val();                   		<if="$vsSettings->getSystemKey($bw->input[0].'_category_list',1,$bw->input[0])">                      		if(!($("#obj-category option:selected").val()&&$("#obj-category option:selected").val()!=0)){                         		error = "<li>{$vsLang->getWords('not_select_category', 'Please select category!')}</li>";                         	flag  = false;                         	$('#obj-category').addClass('ui-state-error ui-corner-all-inner');                      		}                     	</if>                     	var title = $("#obj-title").val();						if(title == 0 || title == ""){							error += "<li>{$vsLang->getWords('null_title', 'Please enter weblink title!')}</li>";							flag  = false;							$('#obj-title').addClass('ui-state-error ui-corner-all-inner');						}                   		var title = $("#obj-address").val();						if(title == 0 || title == ""){							error += "<li>{$vsLang->getWords('null_address', 'Please enter weblink address!')}</li>";							flag  = false;							$('#obj-address').addClass('ui-state-error ui-corner-all-inner');						}                   		if(!flag){							error = "<ul class='ul-popu'>" + error + "</ul>";							vsf.alert(error);							return false;						}						vsf.submitForm($('#add-edit-obj-form'), '{$bw->input[0]}/add-edit-obj-process',"obj-panel");						return false;					});				});                $('#obj-category').change(function() {					var parentId = '';					$("#obj-category option:selected").each(function () {						parentId = $(this).val();					});					$('#obj-cat-id').val(parentId);				});			</script>EOF;	}
	function categoryList($categoryGroup = array()) {
		global $vsLang, $bw;
		$BWHTML .= <<<EOF
			<div class="ui-dialog ui-widget ui-widget-content ui-corner-all">
				<div class="ui-dialog-titlebar ui-widget-header ui-helper-clearfix ui-corner-all-inner">
					<span class="ui-icon ui-icon-triangle-1-e"></span>
					<span class="ui-dialog-title">{$vsLang->getWords('category_table_title_header','Categories')}</span>
				</div>
				<table width="100%" cellpadding="0" cellspacing="1">
					<tr>
				    	<th id="obj-category-message" colspan="2">{$data['message']}{$vsLang->getWords('category_chosen',"Selected categories")}: {$vsLang->getWords('category_not_selected',"None")}</th>
				    </tr>
				    <tr>
				        <td width="220">
				       		<select size="18" style="width: 100%;" id="obj-category">
				        		<option value="0">{$vsLang->getWords('menus_option_root',"Root")}</option>
				        		<if="count($categoryGroup->getChildren())"
				        		<foreach="$categoryGroup->getChildren() as $oMenu">
				        		<option title="{$oMenu->getAlt()}" value="{$oMenu->id}">| - - {$oMenu->title} ({$oMenu->getIndex()} - $oMenu->id)</option>
				        		</foreach>
				        	</select>
				        </td>
				    	<td align="center">
				        	<a class="ui-state-default ui-corner-all ui-state-focus" href="javascript:;" id="view-obj-bt" title='{$vsLang->getWords('view_list_in_cat',"Click here to edit this {$bw->input[0]}")}'>{$vsLang->getWords('global_view','Xem')}</a>
				    		<a class="ui-state-default ui-corner-all ui-state-focus" href="javascript:;" id="add-obj-bt" title='{$vsLang->getWords('add_object_for_cat',"Click here to add this {$bw->input[0]}")}'>{$vsLang->getWords('global_add','Thêm')}</a>
				        </td>
					</tr>
				</table>
			</div>
			
			<script type="text/javascript">
				$('#view-obj-bt').click(function() {
					var categoryId = '';
					$("#obj-category option:selected").each(function () {
						categoryId = $(this).val();
					});
					vsf.get('{$bw->input[0]}/display-obj-list/'+categoryId+'/','obj-panel');
				});
				
				$('#add-obj-bt').click(function(){
					var categoryId = '';
					$("#obj-category option:selected").each(function () {
						categoryId=$(this).val();
					});
					
					$("#idCategory").val(categoryId);
				
					vsf.get('{$bw->input[0]}/add-edit-obj-form/', 'obj-panel');
				});
				
				var parentId = '';
				$('#obj-category').change(function() {
					var currentId = '';
					var parentId = '';
					$("#obj-category option:selected").each(function () {
						currentId += $(this).val() + ',';
						parentId = $(this).val();
					});
										
					currentId = currentId.substr(0, currentId.length-1);
					$("#obj-category-message").html('{$vsLang->getWords('category_chosen',"Selected categories")}:'+currentId);
					$('#obj-cat-id').val(parentId);
				});
			</script>
EOF;
	}
	function displayObjTab($option) {		global $bw,$vsSettings;
		$BWHTML .= <<<EOF			<if="$vsSettings->getSystemKey($bw->input[0].'_category_list',1,$bw->input[0])">		        <div class='left-cell'><div id='category-panel'>{$option['categoryList']}</div></div>				<input type="hidden" id="idCategory" name="idCategory" />				<div id="obj-panel" class="right-cell">{$option['objList']}</div>				<div class="clear"></div>			<else />				<input type="hidden" id="idCategory" name="idCategory" />				<div id="obj-panel" style="width:100%" class="right-cell">{$option['objList']}</div>				<div class="clear"></div>	        </if>EOF;		return $BWHTML;	}
	function managerObjHtml() {		global $bw, $vsLang,$vsSettings;		$BWHTML .= <<<EOF			<div id="page_tabs" class="ui-tabs ui-widget ui-widget-content ui-corner-all-top">				<ul id="tabs_nav" class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-corner-all-inner">			    	<li class="ui-state-default ui-corner-top ui-tabs-selected ui-state-active">			        	<a href="{$bw->base_url}{$bw->input[0]}/display-obj-tab/&ajax=1"><span>{$vsLang->getWords('tab_obj_objes',"{$bw->input[0]}")}</span></a>			        </li>					 <if="$vsSettings->getSystemKey($bw->input[0].'_category_tab',1)">						<li class="ui-state-default ui-corner-top">				        	<a href="{$bw->base_url}menus/display-category-tab/{$bw->input[0]}/&ajax=1"><span>{$vsLang->getWords('global_categories','Categories')}</span></a>				        </li>			        </if>			        <if="$vsSettings->getSystemKey($bw->input[0].'_setting_tab',1)">				        <li class="ui-state-default ui-corner-top">				        	<a href="{$bw->base_url}settings/moduleObjTab/{$bw->input[0]}/&ajax=1">								<span>{$vsLang->getWords("tab_{$bw->input[0]}_SS",'System Settings')}</span>							</a>			        	</li>		        	</if>					</ul>			</div>EOF;		return $BWHTML;	}}
?>